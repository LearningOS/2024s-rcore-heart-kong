# Lab1 实验报告
## 功能总结
本实验添加了获取当前运行的任务信息的系统调用。该系统调用的具体实现为：将TaskControlBlock上的相关信息赋值给参数指针指向的TaskInfo。其中，任务的系统调用次数为字段syscall_times，它将在具体的系统调用之前更新。任务的运行时长及初次运行时间字段为time和start_time, time将在系统调用时更新为当前时间减去start_time。
## 简答作业
### 1
程序出错行为：
- `ch2b_bad_address`: `0x0`是个无效地址，不能写值。
- `ch2b_bad_instructions`: `sret`是S级指令，不在U级使用
- `ch2b_bad_register1`: `sstatus`是S级csr，不能在U级访问

sbi：RustSBI version 0.3.0-alpha.2, adapting to RISC-V SBI v1.0.0
### 2
2.1 a0代表参数，为内核栈栈顶。__restore可以在trap完成时恢复用户态上下文，另外作为函数使用为应用初始化上下文。

2.2 处理了sstatus,sepc和sscratch三个寄存器。sstatus保存了当前特权级的状态信息，确保在恢复用户态之后，中断和异常的处理正常；sepc保存了异常返回地址，处理完Trap后，需要将控制权返回到被中断的指令地址处继续执行。sscratch用于保存内核栈的栈顶指针，确保用户程序能够正确地使用栈空间。

2.3 x2是用户栈寄存器，sscratch中已保存；x4不作使用。

2.4 sp指向用户栈栈顶，sscratch指向内核栈栈顶

2.5 sret；当执行sret指令时，处理器会从内核态切换到用户态。

2.6 sp指向内核栈栈顶，sscratch指向用户栈栈顶

2.7 ecall指令

## 荣誉准则
1. 在完成本次实验的过程（含此前学习的过程）中，我曾分别与 以下各位 就（与本次实验相关的）以下方面做过交流，还在代码中对应的位置以注释形式记录了具体的交流对象及内容：

    无

2. 此外，我也参考了以下资料，还在代码中对应的位置以注释形式记录了具体的参考来源及内容：

    无

1. 我独立完成了本次实验除以上方面之外的所有工作，包括代码与文档。 我清楚地知道，从以上方面获得的信息在一定程度上降低了实验难度，可能会影响起评分。

2. 我从未使用过他人的代码，不管是原封不动地复制，还是经过了某些等价转换。 我未曾也不会向他人（含此后各届同学）复制或公开我的实验代码，我有义务妥善保管好它们。 我提交至本实验的评测系统的代码，均无意于破坏或妨碍任何计算机系统的正常运转。 我清楚地知道，以上情况均为本课程纪律所禁止，若违反，对应的实验成绩将按“-100”分计。